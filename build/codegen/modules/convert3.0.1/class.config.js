const fs = require('fs')
const DateUtil = require("../utils/date")

module.exports = class ConfigBuilder {

  rootPath
  rootName
  json

  constructor(rootPath, rootName, json){
    this.rootPath = rootPath
    this.rootName = rootName
    this.json = json
  }

  createFile(){

    //모듈 파일 생성
    let str = '\n/**\n'
    + '*\n'
    + '* Generated by Rsquare Codegen (v'+this.json.openapi+') ('+DateUtil.now()+')\n'
    + '*\n'
    + `* ${this.rootName} Api Configuration\n`
    + '*\n'
    + '*/\n\n\n'

    //remote target
    str += `const Remote = '${this.json.servers[0].url}'\n`
    str += `export {Remote}\n`

    const fileName = this.rootName + '.config'
    fs.writeFileSync(
      this.rootPath + '/' + fileName + '.ts',
      str, 
      {encoding:'utf-8'}
    )

    return fileName

  }

}